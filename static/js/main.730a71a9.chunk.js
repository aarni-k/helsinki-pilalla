(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{49:function(e,t,a){e.exports=a(97)},54:function(e,t,a){},55:function(e,t,a){},97:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(15),i=a.n(r),l=(a(54),a(9)),o=a(10),c=a(12),u=a(11),p=a(13);a(55);var m=a(7),d=a.n(m),h=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={serviceList:[]},a.btnSelectService=function(e){if(e.preventDefault(),"selectAll"===e.target.value)return a.props.callback({callbackid:"servicecode",service_code:"notUsed",serviceCodeString:"notUsed"});a.props.callback({callbackid:"servicecode",service_code:e.target.value,serviceCodeString:e.target.id})},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.callback({callbackid:"servicecode",service_code:"notUsed"}),fetch("https://asiointi.hel.fi/palautews/rest/v1/services.json?locale=fi").then(function(e){return"400"===e.statusText?"Status 400 - General server error":e.json()}).then(function(t){e.setState({serviceList:t})})}},{key:"render",value:function(){var e=this,t=this.state.serviceList.map(function(t){return s.a.createElement(d.a,{variant:"outline-light",key:t.service_code,onClick:e.btnSelectService,id:t.service_name,value:t.service_code},t.service_name)});return s.a.createElement(s.a.Fragment,null,s.a.createElement(d.a,{variant:"outline-light",value:"selectAll",onClick:this.btnSelectService},"Kaikki"),t)}}]),t}(n.Component),v=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).btnClick=function(e){e.preventDefault(),console.log(e.target.value,"Status btn value!"),a.props.callback({callbackid:"status",status:e.target.value})},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement(d.a,{variant:"outline-light",value:"open",onClick:this.btnClick},"Avoinna"),s.a.createElement(d.a,{variant:"outline-light",value:"closed",onClick:this.btnClick},"Suljettu"))}}]),t}(n.Component),k=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).dateSelector=function(e){e.preventDefault();var t="notUsed";if("NoDate"===e.target.value)return a.props.callback({callbackid:"timerange",end_date:"notUsed",start_date:"notUsed",timeRange:t});if("30"===e.target.value){var n=1;t="Edelliset 30 p\xe4iv\xe4\xe4"}"60"===e.target.value&&(n=2,t="Edelliset 60 p\xe4iv\xe4\xe4"),"90"===e.target.value&&(n=3,t="Edelliset 90 p\xe4iv\xe4\xe4");var s=new Date;s=s.toISOString();var r=new Date;r.setMonth(r.getMonth()-n),r=r.toISOString(),a.props.callback({callbackid:"timerange",end_date:s,start_date:r,timeRange:t})},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.props.callback({callbackid:"timerange",end_date:"notUsed",start_date:"notUsed",timeRange:"notUsed"})}},{key:"render",value:function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement(d.a,{variant:"outline-light",value:"NoDate",onClick:this.dateSelector},"Ei aikav\xe4li\xe4"),s.a.createElement(d.a,{variant:"outline-light",value:"30",onClick:this.dateSelector},"Edelliset 30 p\xe4iv\xe4\xe4"),s.a.createElement(d.a,{variant:"outline-light",value:"60",onClick:this.dateSelector},"Edelliset 60 p\xe4iv\xe4\xe4"),s.a.createElement(d.a,{variant:"outline-light",value:"90",onClick:this.dateSelector},"Edelliset 90 p\xe4iv\xe4\xe4"))}}]),t}(n.Component),g=a(24),b=a.n(g);function E(e,t){var a=new RegExp(t,"i"),n=[];e.map(function(e){if(a.test(e.description)){var t=e.description.search(a),s=e.description.substr(t).search(s);return-1===s&&(s=void 0),n.push(e),e.description}});return console.log(n,"Seleted results"),n}var f=a(44),y=a.n(f),S=a(45),j=a.n(S),I=a(42),C=a.n(I),_=a(43),O=a.n(_),w=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={open:!1},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.setState({open:!1})}},{key:"render",value:function(){var e=this,t=this.state.open;if(this.props.storyItem.description.length>120)var a="".concat(this.props.storyItem.description.substring(0,120),"...");else a=this.props.storyItem.description;var n=this.props.storyItem.requested_datetime.substring(8,10)+"."+this.props.storyItem.requested_datetime.substring(5,7)+"."+this.props.storyItem.requested_datetime.substring(0,4),r="closed"===this.props.storyItem.status?this.props.storyItem.updated_datetime.substring(8,10)+"."+this.props.storyItem.updated_datetime.substring(5,7)+"."+this.props.storyItem.updated_datetime.substring(0,4):"",i="closed"===this.props.storyItem.status?this.props.storyItem.status_notes.search(/yst\xe4v\xe4llisin/i):"";return s.a.createElement(s.a.Fragment,null,s.a.createElement(d.a,{variant:"outline-light",onClick:function(){return e.setState({open:!t})},"aria-controls":"example-collapse-text","aria-expanded":t},a),s.a.createElement(C.a,{in:this.state.open},s.a.createElement("div",{id:"example-collapse-text"},s.a.createElement("hr",null),s.a.createElement("h5",null,"Palautteen p\xe4iv\xe4ys: ",n),s.a.createElement("p",{className:"StoryDescription"},this.props.storyItem.description),null!==this.props.storyItem.lat&null!==this.props.storyItem.long?s.a.createElement("div",{className:"StoryGmapsLink"}," ",s.a.createElement(d.a,{variant:"outline-light",href:"https://www.google.com/maps/search/?api=1&query=".concat(this.props.storyItem.lat,",").concat(this.props.storyItem.long),target:"_blank",rel:"noopener noreferrer"},"Avaa palautteen sijainti Google Mapsissa")," "):"",null!==this.props.storyItem.media_url?s.a.createElement("div",{className:"StoryMediaEmbed"},s.a.createElement(O.a,{src:this.props.storyItem.media_url,width:"33%",height:"33%",rounded:!0})," "):"","closed"===this.props.storyItem.status?s.a.createElement("h5",null,"Vastauksen p\xe4iv\xe4ys: ",r):s.a.createElement("h6",null,"Vastaava yksikk\xf6: ",this.props.storyItem.agency_responsible),"closed"===this.props.storyItem.status?s.a.createElement("p",{className:"StoryDescription"},this.props.storyItem.status_notes.substring(0,i)):"","closed"===this.props.storyItem.status?s.a.createElement("h6",null,"Vastaava yksikk\xf6: ",this.props.storyItem.agency_responsible):"")))}}]),t}(n.Component),R=a(48),A=a.n(R),N=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={status:"closed",serviceCode:"notUsed",serviceCodeString:"notUsed",startDate:"notUsed",endDate:"notUsed",timeRangeString:"notUsed",searchTerm:"",progress:100,progressLabel:"Valmista","v\xe4litulokset":[]},a.showResults=function(){a.setState({progress:33,progressLabel:"Soitellaan kaupungille"}),function(e,t,a,n){"notUsed"!==t&&(t="&service_code="+t),"notUsed"!==a&&"notUsed"!==n&&(a="&start_date="+a,n="&end_date="+n);var s=e="&status="+e;return"notUsed"!==t&&(s+=t),"notUsed"!==a&&"notUsed"!==n&&(s+=a+n),fetch("https://asiointi.hel.fi/palautews/rest/v1/requests.json?locale=fi"+s).then(function(e){return e.json()})}(a.state.status,a.state.serviceCode,a.state.startDate,a.state.endDate).then(function(e){a.setState({progress:66,progressLabel:"Putsataan vastauksia"});var t=a.state.searchTerm;a.setState({serviceRequests:E(e,t),progress:100,progressLabel:"Valmis!"})})},a.callbackFunction=function(e){"status"===e.callbackid&&a.setState({status:e.status}),"servicecode"===e.callbackid&&a.setState({serviceCode:e.service_code,serviceCodeString:e.serviceCodeString}),"timerange"===e.callbackid&&a.setState({startDate:e.start_date,endDate:e.end_date,timeRangeString:e.timeRange})},a.btnSearch=function(e){e.preventDefault(),a.setState({progress:0,progressLabel:"Aloitetaan haku"}),a.showResults()},a.filterChanged=function(e){a.setState({searchTerm:e.target.value})},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.showResults()}},{key:"render",value:function(){var e="";e="notUsed"===this.state.serviceCode?"Kaikki palvelut":this.state.serviceCodeString;var t="";t="closed"===this.state.status?"Suljettu":"Avoinna";var a="";a="notUsed"===this.state.timeRangeString?"Ei aikav\xe4li\xe4":this.state.timeRangeString;var n="";n=""===this.state.searchTerm?"Suodatetaan palaute, josta l\xf6ytyy merkkijono":'Suodatetaan palaute, jossa esiintyy annettu merkkijono "'.concat(this.state.searchTerm,'"');var r="";if(void 0===this.state.serviceRequests&&(r="Ladataan sivustoa"),void 0!==this.state.serviceRequests&&0!==this.state.serviceRequests.length&&(r="Hakutuloksia yhteens\xe4 ".concat(this.state.serviceRequests.length)),void 0!==this.state.serviceRequests&&0===this.state.serviceRequests.length&&(r="Ei hakutuloksia"),void 0!==this.state.serviceRequests)var i=this.state.serviceRequests.map(function(e){if(void 0!==e&&""!==e.description)return s.a.createElement("div",{className:"FeedBackItem",key:e.service_request_id},s.a.createElement(w,{storyItem:e}))});var l=s.a.createElement(y.a,{id:"popover-basic",title:"HELSINKI-PILALLA "},s.a.createElement("p",null,"Sivusto on tehty harjoitusmieless\xe4 k\xe4ytt\xe4en hyv\xe4ksi ",s.a.createElement("a",{href:"https://dev.hel.fi/apis/open311/",target:"_blank",rel:"noopener noreferrer"},"dev.hel.fi Open311"),'  API:a. Hakutoiminto on toteutettu regEx:ll\xe4 ja kaupungin vastauksista on poistettu kaikki teksti "Yst\xe4v\xe4llisin terveisin" kohdan j\xe4lkeen. API palauttaa joko 200 ensimm\xe4ist\xe4 tulosta tai, jos valittuna, tulokset maksimissaan 90 p\xe4iv\xe4n ajalta. Palvelulistaus on rakennettu API:n pohjalta. Jatkossa on tarkoitus lis\xe4t\xe4 erilaisia valmiita hakuja (esimerkiksi vuosihaut) sek\xe4 aihesuodattimia kuten roskakorit, siirtokehoitukset jne. L\xe4hdekoodi l\xf6ytyy ',s.a.createElement("a",{href:"https://github.com/aarni-k/helsinki-pilalla/",target:"_blank",rel:"noopener noreferrer"},"GitHubista"),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("list",null,s.a.createElement("strong",null,"Toteutus"),s.a.createElement("ul",null,s.a.createElement("li",null,"ReactJS & React-Bootstrap"),s.a.createElement("li",null,"dev.hel.fi Open311 API"),s.a.createElement("li",null,"JavaScript RegEx"))),s.a.createElement("strong",null,"-Aarni")));return s.a.createElement("div",{className:"FeedBackStories"},s.a.createElement("div",{className:"TopContent"},s.a.createElement("h6",null,"Katsele kaupungin palautteita - Lis\xe4tietoa info-napin takana!"),s.a.createElement("div",{className:"SearchButton"},s.a.createElement(d.a,{variant:"outline-light",onClick:this.btnSearch,value:this.state.searchTerm},"Hae!"),"\xa0",s.a.createElement(function(){return s.a.createElement(j.a,{trigger:"click",placement:"right",overlay:l},s.a.createElement(d.a,{variant:"outline-light"},"Info"))},null)),s.a.createElement("div",{className:"SearchBar"},s.a.createElement(A.a,{variant:"dark",now:this.state.progress,label:this.state.progressLabel}),s.a.createElement("br",null),s.a.createElement("h4",null,n),s.a.createElement(b.a,null,s.a.createElement(b.a.Group,null,s.a.createElement(b.a.Control,{size:"lg",type:"text",placeholder:"Suodatin / Kokeile kiit, niin l\xf6yd\xe4t kiitokset",onChange:this.filterChanged})))),s.a.createElement("div",{className:"InnerTopContent"},s.a.createElement("div",{className:"ServiceType"},s.a.createElement("h4",null,"Valittuna: ",e," "),s.a.createElement(h,{callback:this.callbackFunction}))),s.a.createElement("div",{className:"InnerTopContent"},s.a.createElement("div",{className:"SelectStatus"},s.a.createElement("h4",null,"Valittuna: ",t),s.a.createElement(v,{callback:this.callbackFunction})),s.a.createElement("div",{className:"TimeRange"},s.a.createElement("h4",null,"Valittuna: ",a),s.a.createElement(k,{callback:this.callbackFunction})))),s.a.createElement("div",{className:"FeedBackStories"},s.a.createElement("h4",null,r),i))}}]),t}(n.Component),U=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"App"},s.a.createElement("header",{className:"App-header"},s.a.createElement("h1",null,"HELSINKI-PILALLA")),s.a.createElement(N,null),s.a.createElement("div",{className:"BottomFiller"}))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(s.a.createElement(U,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[49,1,2]]]);
//# sourceMappingURL=main.730a71a9.chunk.js.map